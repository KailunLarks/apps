import { useState } from 'react';

interface MenuItem {
  label: string;
  items: string[];
  color: string;
  icon: string;
}

const menuData: Record<string, MenuItem> = {
  '生态变化': {
    label: '生态变化',
    items: ['森林覆盖变化', '湿地保护进展', '水质监测数据', '生物多样性'],
    color: 'bg-green-400/20 hover:bg-green-600/40',
    icon: '<svg viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M52.4199 8.01651C56.8335 4.42028 63.1665 4.42028 67.5801 8.01651L101.275 35.4726C109.298 42.0096 104.676 54.9998 94.3272 54.9999H88.5771L108.738 70.2206C117.161 76.5794 112.664 89.9998 102.11 89.9999H72.1914L74.3379 103.42C75.3099 109.495 70.6168 115 64.4639 115H55.5361C49.3831 115 44.6901 109.496 45.6621 103.42L47.8086 89.9999H17.8896C7.33608 89.9999 2.83901 76.5794 11.2617 70.2206L31.4228 54.9999H25.6728C15.3241 54.9999 10.7019 42.0096 18.7246 35.4726L52.4199 8.01651Z" fill="currentColor"/></svg>'
  },
  '学术变化': {
    label: '学术变化',
    items: ['研究项目进展', '论文发表情况', '学术合作机构', '科研成果展示'],
    color: 'bg-blue-400/20 hover:bg-blue-600/40',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120" fill="none"><path d="M99.6553 10.3818C106.568 9.85728 112 15.455 112 22.0576V92.2372C112 98.7508 106.867 103.927 100.612 104.478C86.5023 105.723 67.2307 108.85 61.9971 109.721C60.6696 109.942 59.3304 109.942 58.0029 109.721C52.7693 108.85 33.4977 105.723 19.3877 104.478C13.1333 103.927 8.00014 98.7508 8 92.2372V22.0576C8.00016 15.455 13.4324 9.85728 20.3447 10.3818C35.2064 11.51 53.9198 14.8175 59.2344 15.79C59.7476 15.8838 60.2524 15.8838 60.7656 15.79C66.0802 14.8175 84.7936 11.51 99.6553 10.3818ZM60 26.9999C57.7909 26.9999 56 28.7908 56 30.9999V93.9999C56 96.2091 57.7909 97.9999 60 97.9999C62.2091 97.9999 64 96.2091 64 93.9999V30.9999C64 28.7908 62.2091 26.9999 60 26.9999Z" fill="currentColor"/></svg>'
  },
  '商业变化': {
    label: '商业变化',
    items: ['投资项目动态', '经济发展指标', '就业机会变化', '商业区规划'],
    color: 'bg-orange-400/20 hover:bg-orange-600/40',
    icon: '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120" fill="none"><path d="M49.3018 38.0566C57.2165 34.6889 65.9999 40.4971 66 49.0986V113H23C16.3726 113 11 107.627 11 101V62.29C11 57.4785 13.8744 53.132 18.3018 51.248L49.3018 38.0566Z" fill="currentColor"/><path d="M97 7C103.627 7 109 12.3726 109 19V101C109 107.627 103.627 113 97 113H73V49.0986C73 36.7171 61.5055 27.9908 50 30.5137V19C50 12.3726 55.3726 7 62 7H97ZM92 51C89.2386 51 87 53.2386 87 56C87 58.7614 89.2386 61 92 61C94.7614 61 97 58.7614 97 56C97 53.2386 94.7614 51 92 51ZM92 35C89.2386 35 87 37.2386 87 40C87 42.7614 89.2386 45 92 45C94.7614 45 97 42.7614 97 40C97 37.2386 94.7614 35 92 35ZM92 19C89.2386 19 87 21.2386 87 24C87 26.7614 89.2386 29 92 29C94.7614 29 97 26.7614 97 24C97 21.2386 94.7614 19 92 19Z" fill="currentColor" opacity="0.5"/></svg>'
  },
  '交通变化': {
    label: '交通变化',
    items: ['道路建设进度', '公共交通发展', '港口设施更新', '交通流量分析'],
    color: 'bg-red-400/20 hover:bg-red-600/40',
    icon: '<svg viewBox="0 0 120 120" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M79.5547 13C88.5454 13 96.4314 18.9993 98.8301 27.6641L106.27 54.542L106.349 54.6963L106.925 55.751C107.009 55.9027 107.096 56.0539 107.183 56.2061C107.287 56.3901 107.392 56.5753 107.498 56.7607C107.949 57.546 108.419 58.3444 108.905 59.1738C110.235 61.4366 111.709 63.9522 112.873 66.7119C112.917 66.8165 112.96 66.9219 113.004 67.0273C113.021 67.0686 113.038 67.11 113.055 67.1514C113.701 68.7365 114.241 70.4135 114.586 72.1855C114.597 72.2404 114.607 72.2955 114.617 72.3506C114.794 73.2945 114.917 74.2646 114.967 75.2627C114.969 75.3092 114.971 75.3558 114.973 75.4023C114.981 75.5849 114.988 75.7687 114.991 75.9531L114.999 76.7246C115.017 80.629 114.661 85.1442 113.246 88.9082C111.074 94.6841 104.9 100 97.7559 100H97V105C97 107.209 95.2092 109 93 109C90.791 109 89 107.209 89 105V100H31V105C31 107.209 29.2091 109 27 109C24.791 109 23 107.209 23 105V100H21.7441C14.585 99.9997 8.46421 94.6595 6.4209 88.8213C4.91853 84.5284 4.84936 79.2811 5.12696 75.0361C5.14283 74.7935 5.16433 74.5523 5.18848 74.3125C5.1961 74.2364 5.20546 74.1607 5.21387 74.085C5.23129 73.9291 5.24976 73.7738 5.27051 73.6191C5.28188 73.5339 5.29431 73.449 5.30664 73.3643C5.32574 73.2339 5.3468 73.1041 5.36817 72.9746C5.76647 70.5471 6.55034 68.3052 7.49903 66.2354C7.5448 66.1351 7.59115 66.0351 7.6377 65.9355C7.66984 65.8671 7.70191 65.7986 7.73438 65.7305C7.9096 65.3615 8.0913 64.998 8.27539 64.6387C8.30765 64.5759 8.3406 64.5136 8.37305 64.4512C9.27406 62.713 10.2591 61.0876 11.1953 59.5762C11.229 59.5216 11.2623 59.4665 11.2959 59.4121C12.2164 57.9239 13.0784 56.5566 13.8848 55.1641C14.0043 54.9576 14.1152 54.7502 14.2217 54.5449L21.6641 27.6641C24.0627 18.9994 31.9489 13.0001 40.9395 13H79.5547ZM32 70C28.6864 70.0001 26 72.6863 26 76C26 79.3137 28.6864 81.9999 32 82C35.3137 82 38 79.3137 38 76C38 72.6863 35.3137 70 32 70ZM88 70C84.6864 70.0001 82 72.6863 82 76C82 79.3137 84.6864 81.9999 88 82C91.3137 82 94 79.3137 94 76C94 72.6863 91.3137 70 88 70ZM40.9395 21C35.5451 21.0001 30.8132 24.5999 29.374 29.7988L23.1182 52.3955C25.451 52.5709 28.5139 52.7911 32.0381 53.0078C40.1328 53.5056 50.6101 54 60.2471 54C69.8841 54 80.3613 53.5056 88.4561 53.0078C91.9793 52.7911 95.0415 52.5709 97.374 52.3955L91.1201 29.7988C89.681 24.5999 84.9492 21 79.5547 21H40.9395ZM7.20508 36.7354C7.90365 34.6398 10.1691 33.5069 12.2647 34.2051C14.3603 34.9036 15.4932 37.169 14.7949 39.2646L11.7949 48.2646C11.0964 50.3603 8.83104 51.4933 6.73535 50.7949C4.63986 50.0963 3.50675 47.8309 4.20508 45.7354L7.20508 36.7354ZM107.735 34.2051C109.831 33.5067 112.096 34.6398 112.795 36.7354L115.795 45.7354C116.493 47.831 115.36 50.0964 113.265 50.7949C111.169 51.4932 108.904 50.3603 108.205 48.2646L105.205 39.2646C104.507 37.1691 105.64 34.9037 107.735 34.2051Z" fill="currentColor"/></svg>'
  }
};

export default function HeaderControls() {
  const [activeMenu, setActiveMenu] = useState<string | null>(null);

  const toggleMenu = (menuKey: string) => {
    setActiveMenu(activeMenu === menuKey ? null : menuKey);
  };

  const closeMenu = () => {
    setActiveMenu(null);
  };

  return (
    <>
      {/* 上部分：标题 */}
      <div className="absolute top-0 left-0 right-0 z-10 p-8 pointer-events-none bg-linear-to-t from-neutral-600/0 from-0% via-neutral-800/10 via-20% to-neutral-800/90 to-100%">
        <p className="text-base text-stone-50/80 text-shadow-xs"> 欢迎来到 islandMap</p>
        <h1 className="text-2xl font-bold text-stone-50 text-shadow-xs">和地图一起探索海甸岛的过往时光</h1>
      </div>

      {/* 下部分：按钮组 */}
      <div className="p-8 absolute bottom-0 left-0 right-0 z-10 pointer-events-none bg-linear-to-b from-neutral-600/0 from-0% via-neutral-800/10 via-20% to-neutral-800/90 to-100%">
      <div >
        <p className="text-base text-stone-50/96 mb-2 mt-4">从地点类别开始了解</p>
      </div>
        <div className="flex gap-2 flex-wrap relative pointer-events-auto">
          {Object.keys(menuData).map((key) => (
            <div key={key} className="relative">
              <button
                className={`shadow-xl bg-blend-lighten backdrop-blur-md px-5 py-3 w-40 flex ${menuData[key].color} text-white rounded-4xl transition-colors items-center gap-2`}
                onClick={() => toggleMenu(key)}
              >
                <span className="w-6 h-6" dangerouslySetInnerHTML={{ __html: menuData[key].icon }} />
                {key}
              </button>

              {/* 下拉菜单 */}
              {activeMenu === key && (
                <div className="absolute bottom-full left-0 mb-1 w-48 bg-white border border-neutral-3 rounded-lg shadow-lg z-20">
                  <ul className="py-1">
                    {menuData[key].items.map((item, index) => (
                      <li key={index}>
                        <button
                          className="w-full text-left px-4 py-2 text-sm text-neutral-12 hover:bg-neutral-2 transition-colors"
                          onClick={() => {
                            // 这里可以添加具体的操作逻辑
                            console.log(`Selected: ${item}`);
                            closeMenu();
                          }}
                        >
                          {item}
                        </button>
                      </li>
                    ))}
                  </ul>
                </div>
              )}
            </div>
          ))}
        </div>
      </div>

      {/* 点击其他地方关闭菜单 */}
      {activeMenu && (
        <div
          className="fixed inset-0 z-10"
          onClick={closeMenu}
        />
      )}
    </>
  );
}